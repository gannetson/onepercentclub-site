!function(t){"use strict";var e=function(t){var e=new XMLHttpRequest;e.addEventListener("load",function(){t.success(e.response)},!1),e.open("GET",t.file,!0),e.responseType="arraybuffer",e.send()},a=function(){return{register:function(t){this.callback=t.callback,this.context=t.context},execute:function(){this.callback&&this.callback.call(this.context)}}},i=function(t){if(!t)throw"You need to pass a value as parameter!";this._cachedVariabes(t),this._load()};i.prototype={_validateFormat:function(){var t=/\.(mp3|opus|ogg|wav|m4a|weba)$/,e=t.test(this.file);if(!e)throw"The format of the audio file is invalid!"},_createInstance:function(){var e=t.AudioContext||t.webkitAudioContext||null,a=e;if(!a)throw"Your browser does not support API AudioContext!";this.audioContext=new e},_cachedVariabes:function(t){this._createInstance();var e="string"==typeof t;e?this.file=t:(this.file=t.file,this.autoPlay=t.autoPlay),this._validateFormat(),this.callbackManager=new a},_load:function(){var t=this;e({file:this.file,success:function(e){t._decodeAudioData.call(t,e)}})},_decodeAudioData:function(t){var e=this,a=this.audioContext;a.decodeAudioData(t,function(t){e.source=a.createBufferSource(),e.source.buffer=t,e.source.connect(a.destination),(e.autoPlay||e.shouldPlay)&&(e.callbackManager.register({callback:e._play,context:e}),e.callbackManager.execute())},function(){throw"Decoding the audio buffer failed!"})},_play:function(){this.source.start(0),this.isStarted=!0},play:function(){this.callbackManager.register({callback:this._play,context:this}),this.shouldPlay=!0},stop:function(){this.isStarted&&(this.source.stop(0),this.isStarted=!1)}},t.audioJS=function(t){return new i(t)}}(this);
